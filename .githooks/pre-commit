#!/bin/sh
# Pre-commit hook: Run biome check on staged files

echo "Running biome check..."

# Get staged TypeScript files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(ts|tsx|js|jsx|json)$' || true)

if [ -z "$STAGED_FILES" ]; then
  echo "No staged files to check"
  exit 0
fi

# Run biome check on staged files
echo "$STAGED_FILES" | xargs bunx biome check --no-errors-on-unmatched

if [ $? -ne 0 ]; then
  echo ""
  echo "❌ Biome check failed. Please fix the issues above."
  echo "   Run 'bun run check:fix' to auto-fix issues."
  exit 1
fi

echo "✓ Biome check passed"
